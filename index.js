
const carDatabase = [
  {
    "number": "С 455 ЕЕ 64",
    "name": 0,
    "apartment": 37,
    "phone": "8-927-148-88-64; 8-937-221-89-01"
  },
  {
    "number": "Т 071 МТ 67",
    "name": 0,
    "apartment": 33,
    "phone": ""
  },
  {
    "number": "Р 361 ЕЕ",
    "name": 0,
    "apartment": 41,
    "phone": "8-927-220-29-08"
  },
  {
    "number": "В 741 ХС",
    "name": 0,
    "apartment": 21,
    "phone": "8-937-975-14-21"
  },
  {
    "number": "М 848 РЕ",
    "name": 0,
    "apartment": 25,
    "phone": "8-917-207-51-13; 8-987-335-25-42"
  },
  {
    "number": "К 846 АМ",
    "name": 0,
    "apartment": 79,
    "phone": "8-927-229-34-29; 8-927-229-03-75"
  },
  {
    "number": "М 648 РЕ",
    "name": 0,
    "apartment": 65,
    "phone": "8-937-636-36-89"
  },
  {
    "number": "486",
    "name": 0,
    "apartment": 95,
    "phone": "8-937-241-26-46"
  },
  {
    "number": "В 236 ХК",
    "name": 0,
    "apartment": 98,
    "phone": "8-927-121-37-54"
  },
  {
    "number": "К 365 ХС",
    "name": 0,
    "apartment": 19,
    "phone": "8-917-971-21-71"
  },
  {
    "number": "Н 096 ВМ",
    "name": 0,
    "apartment": 50,
    "phone": "8-937-967-62-99"
  },
  {
    "number": "М 639 ВК",
    "name": 0,
    "apartment": 24,
    "phone": "8-937-969-63-31; 8-995-640-05-12"
  },
  {
    "number": "P 393 НХ",
    "name": 0,
    "apartment": 89,
    "phone": "8-937-269-03-58"
  },
  {
    "number": "К 697 УХ 164",
    "name": 0,
    "apartment": 78,
    "phone": "8-937-243-07-58"
  },
  {
    "number": "437",
    "name": 0,
    "apartment": 0,
    "phone": "8-929-776-23-43; 8-904-241-55-31"
  },
  {
    "number": "X 095 НА",
    "name": 0,
    "apartment": 74,
    "phone": "8-987-829-93-39"
  },
  {
    "number": "У 236 ТО",
    "name": 0,
    "apartment": 65,
    "phone": "8-937-636-36-89"
  },
  {
    "number": "К 108 УН",
    "name": 0,
    "apartment": 12,
    "phone": "8-927-626-59-51; 8-987-803-04-39"
  },
  {
    "number": "Х 797 ЕР",
    "name": 0,
    "apartment": 0,
    "phone": ""
  },
  {
    "number": "М 439 СХ",
    "name": 0,
    "apartment": 0,
    "phone": ""
  },
  {
    "number": "В 558 КР",
    "name": 0,
    "apartment": 1,
    "phone": "8-927-156-78-73"
  },
  {
    "number": "Е 247 РА",
    "name": 0,
    "apartment": 38,
    "phone": "8-902-042-67-62"
  },
  {
    "number": "М 969 ТЕ",
    "name": 0,
    "apartment": 1,
    "phone": "8-927-156-78-73"
  },
  {
    "number": "947",
    "name": 0,
    "apartment": 60,
    "phone": "8-937-961-49-95; 8-927-052-68-28"
  },
  {
    "number": "Е 275 ОН",
    "name": 0,
    "apartment": 8,
    "phone": "8-937-268-10-08"
  },
  {
    "number": "Т 909 АХ",
    "name": 0,
    "apartment": 57,
    "phone": "8-927-225-37-64; 8-927-225-37-23"
  },
  {
    "number": "В 330 ВХ",
    "name": 0,
    "apartment": 57,
    "phone": "8-927-225-37-64; 8-927-225-37-23"
  },
  {
    "number": "К 809 КА",
    "name": 0,
    "apartment": 41,
    "phone": "8-927-220-29-08"
  },
  {
    "number": "786",
    "name": 0,
    "apartment": 95,
    "phone": "8-937-241-26-46"
  },
  {
    "number": "В 929 СК",
    "name": 0,
    "apartment": 9,
    "phone": "8-902-048-99-40"
  },
  {
    "number": "М 240 ХН",
    "name": 0,
    "apartment": 9,
    "phone": "8-902-048-99-40"
  },
  {
    "number": "У 026 МО",
    "name": 0,
    "apartment": 42,
    "phone": "8-996-128-98-58"
  },
  {
    "number": "М 463 ХТ 164",
    "name": 0,
    "apartment": 73,
    "phone": "8-937-266-27-27"
  },
  {
    "number": "960",
    "name": 0,
    "apartment": 101,
    "phone": "8-999-811-55-69"
  },
  {
    "number": "К 024 СХ",
    "name": 0,
    "apartment": 98,
    "phone": "8-927-121-37-54"
  },
  {
    "number": "Н 122 ВС",
    "name": 0,
    "apartment": 35,
    "phone": "8-987-834-35-44"
  },
  {
    "number": "О 934 ОО",
    "name": 0,
    "apartment": 48,
    "phone": "8-927-106-73-76"
  },
  {
    "number": "К 223 КХ",
    "name": 0,
    "apartment": 26,
    "phone": "8-917-318-95-27"
  }
];


const carNumberInput = document.getElementById('carNumberInput');
const searchButton = document.getElementById('searchButton');
const resultContainer = document.getElementById('resultContainer');
const resultInfo = document.getElementById('resultInfo');
const errorElement = document.getElementById('error');
//anmate
const h1 = document.querySelector('h1');
    const text = h1.textContent;
    h1.textContent = '';
    
    let i = 0;
    const cursor = document.createElement('span');
    cursor.textContent = '|';
    cursor.style.animation = 'blink 1s infinite';
    cursor.style.marginLeft = '5px';
    h1.appendChild(cursor);
    
    const typingEffect = setInterval(() => {
      if (i < text.length) {
        h1.insertBefore(document.createTextNode(text.charAt(i)), cursor);
        i++;
      } else {
        clearInterval(typingEffect);
        // Замедляем мигание курсора после завершения
        cursor.style.animation = 'blink 1.5s infinite';
      }
    }, 80);
//q

function normalizeNumber(number) {
    return number.replace(/\s+/g, '').toUpperCase();
}


function extractDigits(number) {
    return number.replace(/\D/g, '');
}


function searchCar() {
    const inputNumber = carNumberInput.value.trim();
    
   
    if (!inputNumber) {
        showError('Пожалуйста, введите номер автомобиля');
        hideResult();
        return;
    }
    
    const normalizedInput = normalizeNumber(inputNumber);
    const digitsInput = extractDigits(inputNumber);
    
  
    let car = carDatabase.find(car => {
        const normalizedCarNumber = normalizeNumber(car.number);
        return normalizedCarNumber === normalizedInput;
    });
    
    
    if (!car && digitsInput) {
        car = carDatabase.find(car => {
            const carDigits = extractDigits(car.number);
            return carDigits === digitsInput;
        });
    }
    
    if (car) {
        hideError();
        showResult(car);
    } else {
        hideError();
        showNoResult();
    }
}


// Показать результат
function showResult(car) {
    // Форматируем имя (если 0, то показываем "Не указано")
    const name = car.name === 0 ? '<span class="missing">Не указано</span>' : car.name;
    
    // Форматируем телефон для звонка (убираем дефисы и пробелы, добавляем +7)
    let phoneLink = '';
    let phoneDisplay = '';
    
    if (car.phone) {
        // Берём первый номер, если их несколько (через точку с запятой)
        const phones = car.phone.split(';');
        const firstPhone = phones[0].trim();
        
        // Форматируем для отображения
        phoneDisplay = car.phone.replace(/;/g, '<br>');
        
        // Форматируем для ссылки tel: (только цифры)
        phoneLink = firstPhone.replace(/\D/g, '');
        // Добавляем 7 в начало, если её нет
        if (!phoneLink.startsWith('7')) {
            phoneLink = '7' + phoneLink;
        }
        if (!phoneLink.startsWith('7') && !phoneLink.startsWith('8')) {
            phoneLink = '7' + phoneLink;
        }
    }
    
    let phoneHtml = '';
    if (car.phone) {
        phoneHtml = `
            <p><strong>Телефон:</strong></p>
            <p>${phoneDisplay}</p>
            <div class="phone-container">
                <a href="tel:+${phoneLink}" class="call-button">
                     Позвонить
                </a>
            </div>
        `;
    } else {
        phoneHtml = '<p><strong>Телефон:</strong> <span class="missing">Не указан</span></p>';
    }
    
    resultInfo.innerHTML = `
        <p><strong>Номер авто:</strong> ${car.number}</p>
        <p><strong>Квартира:</strong> № ${car.apartment}</p>
        <p><strong>Имя:</strong> ${name}</p>
        ${phoneHtml}
    `;
    resultContainer.classList.add('show');
}


function showNoResult() {
    resultInfo.innerHTML = `
        <div class="no-result">
            <p>❌ Автомобиль с таким номером не найден</p>
            <p style="margin-top: 10px; font-size: 14px;">Попробуйте проверить правильность ввода</p>
            <p style="font-size: 14px;">Возможно автомобиля нет в базе</p>
        </div>
    `;
    resultContainer.classList.add('show');
}


function hideResult() {
    resultContainer.classList.remove('show');
}


function showError(message) {
    errorElement.textContent = message;
    errorElement.style.display = 'block';
}


function hideError() {
    errorElement.style.display = 'none';
}


searchButton.addEventListener('click', searchCar);

carNumberInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        searchCar();
    }
});


carNumberInput.addEventListener('input', () => {
    hideError();
    hideResult();
});


window.addEventListener('load', () => {
    carNumberInput.focus();

});





